<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/bootstrap.css">
</head>
<body>
    <div class="container">
        <h1></h1>
        <div class="row">
          <div class="col-8">
              <form action="#" method="post" name="form1" class="form-horizontal">
                <div class="form-group">
                  <label class="col-3 control-label">用户名：</label>
                  <div class="col-6">
                    <input type="text" name="username" class="form-control" placeholder="用户名">
                  </div>
                  <div class="col-3">
                    <span class="text-danger" id="uname_show"></span>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-md-3 control-label">邮箱：</label>
                  <div class="col-md-6">
                    <input type="email" name="email" class="form-control" placeholder="邮箱">
                  </div>
                  <div class="col-md-3">
                    <span class="text-danger"></span>
                  </div>
                </div><div class="form-group">
                <label class="col-md-3 control-label">年龄：</label>
                <div class="col-md-6">
                  <input type="number" name="age" class="form-control" placeholder="年龄">
                </div>
                <div class="col-md-3">
                  <span class="text-danger"></span>
                </div>
              </div>
  
              </form>
          </div>
        </div>
    </div>
    <script src="./js/bootstrap.js"></script>
    <script src="./js/popper.min.js"></script>
    <script src="./js/jquery.slim.min.js"></script>
    <script>
        var xmlhttp;
        var uname_input=document.querySelector("input[name='username']");
        uname_input.onblur=function(){
            initXHR();
            xmlhttp.onreadystatechange=function(){
                if(xmlhttp.readyState==4&&xmlhttp.status==200){
                    var resp=xmlhttp.responseText;
                    if(resp=="true"){
                        document.querySelector("#uname_show").innerHTML="用户名已存在";
                        uname_input.focus();
                        uname_input.select();
                    }else{
                        document.querySelector("#uname_show").innerHTML="用户名合法";
                        document.querySelector("#uname_show").className="text-success";
                    }
                }
            }
            xmlhttp.open("get","ajax/validateName?username="+uname_input.value,true);
            xmlhttp.send();
        }
        function initXHR(){
            if(window.XMLHttpRequest){
                xmlhttp=new XMLHttpRequest();
            }else{
                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")
            }
        }
    </script>
</body>
</html>